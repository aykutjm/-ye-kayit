<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atakum Tenis KulÃ¼bÃ¼ - Ãœyelik SÃ¶zleÅŸmesi</title>
    <!-- YÃ¼ksek Kaliteli Resim iÃ§in html2canvas kÃ¼tÃ¼phanesi -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --dark-green: #2d5a27;
            --light-green: #4a7c59;
            --light-bg: #f8f9ff;
            --border-color: #e1e5e9;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%); min-height: 100vh; padding: 20px; color: #333; }
        .container { max-width: 900px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.1); overflow: hidden; }
        .header { background: linear-gradient(135deg, var(--dark-green) 0%, var(--light-green) 100%); color: white; padding: 30px; text-align: center; }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .header p { font-size: 1.2em; opacity: 0.9; }
        .form-container { padding: 40px; }
        .form-section { margin-bottom: 30px; padding: 25px; border-radius: 15px; background: var(--light-bg); border-left: 5px solid var(--primary-color); }
        .section-title { font-size: 1.4em; color: var(--dark-green); margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .form-group { display: flex; flex-direction: column; }
        label { font-weight: 600; margin-bottom: 8px; font-size: 0.95em; }
        input, select, textarea { padding: 12px 15px; border: 2px solid var(--border-color); border-radius: 10px; font-size: 1em; transition: all 0.3s ease; width: 100%; }
        input:focus, select:focus, textarea:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); }
        .contract-text { background: white; padding: 25px; border-radius: 10px; border: 2px solid var(--border-color); height: 400px; overflow-y: auto; font-size: 0.85em; line-height: 1.6; }
        .signature-section { background: #fff; border: 2px dashed var(--primary-color); border-radius: 15px; padding: 30px; text-align: center; }
        .signature-canvas { border: 2px solid var(--border-color); border-radius: 10px; cursor: crosshair; display: block; margin: 20px auto; max-width: 100%; }
        .btn { padding: 12px 25px; border: none; border-radius: 25px; font-size: 1em; font-weight: 600; cursor: pointer; transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 0.5px; }
        .btn-secondary { background: #f8f9fa; color: #6c757d; border: 2px solid var(--border-color); }
        .btn-success { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; font-size: 1.2em; padding: 15px 40px; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0,0,0,0.15); }
        .checkbox-group { display: flex; align-items: flex-start; gap: 15px; margin-top: 20px; }
        .checkbox-group input { width: 20px; height: 20px; margin-top: 3px; flex-shrink: 0;}
        .warning, .info-box { background: #fff3cd; border-left: 5px solid #ffeaa7; color: #856404; padding: 15px; border-radius: 10px; margin: 15px 0; }
        .success-message { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; padding: 20px; border-radius: 15px; text-align: center; margin-top: 20px; display: none; }
    </style>
</head>
<body>
    
    <div class="container" id="main-container">
        <div class="header">
            <h1>ğŸ¾ Atakum Tenis KulÃ¼bÃ¼</h1>
            <p>Online Ãœyelik SÃ¶zleÅŸmesi</p>
        </div>
        <div class="form-container">
            <form id="membershipForm">
                <div class="form-section">
                    <h3 class="section-title">ğŸ‘¤ Ãœye / Veli Bilgileri</h3>
                    <div class="form-grid">
                        <div class="form-group"><label for="fullName">Ad Soyad *</label><input type="text" id="fullName" name="Ad_Soyad" required></div>
                        <div class="form-group"><label for="tcno">T.C. Kimlik No *</label><input type="text" id="tcno" name="TC_Kimlik_No" pattern="[0-9]{11}" maxlength="11" required></div>
                        <div class="form-group"><label for="phone">Telefon *</label><input type="tel" id="phone" name="Telefon" required></div>
                        <div class="form-group"><label for="email">E-posta *</label><input type="email" id="email" name="Eposta" required></div>
                    </div>
                    <div class="form-group" style="margin-top: 20px;"><label for="address">Adres *</label><textarea id="address" name="Adres" rows="3" required></textarea></div>
                </div>
                 <div class="form-section">
                    <h3 class="section-title">ğŸ—“ï¸ Ãœyelik SÃ¼resi</h3>
                    <div class="form-group">
                        <label for="membershipDuration">Ãœyelik SÃ¼resini SeÃ§iniz *</label>
                        <select id="membershipDuration" name="Uyelik_Suresi" required>
                            <option value="">SeÃ§iniz...</option>
                            <option value="AylÄ±k">AylÄ±k</option>
                            <option value="4 AylÄ±k">4 AylÄ±k</option>
                        </select>
                    </div>
                    <div id="monthlyWarning" class="info-box" style="display: none;"><strong>Bilgilendirme:</strong> AylÄ±k Ã¼yeliklerde, Ã¼yeliÄŸinizi sonlandÄ±rmak iÃ§in her ayÄ±n 14'Ã¼ne kadar kayÄ±t sildirmeniz gerekmektedir. Aksi takdirde Ã¼yelik otomatik olarak yenilenir.</div>
                    <div id="fourMonthWarning" class="info-box" style="display: none;"><strong>Bilgilendirme:</strong> 4 aylÄ±k Ã¼yeliklerde, sÃ¼reden Ã¶nce iptal edilen Ã¼yeliklerde sÃ¶zleÅŸme gereÄŸi cayma bedeli tahsil edilir.</div>
                </div>
                 <div class="form-section">
                    <h3 class="section-title">ğŸ‘¶ ReÅŸit Olmayan Ãœye</h3>
                    <div class="checkbox-group">
                        <input type="checkbox" id="isMinorCheck" name="Resit_Olmayan_Uye_Mi">
                        <label for="isMinorCheck">18 yaÅŸÄ±ndan kÃ¼Ã§Ã¼k bir Ã¼ye iÃ§in dolduruyorum.</label>
                    </div>
                    <div id="minorFields" style="display: none; margin-top: 20px;">
                        <div class="form-grid">
                            <div class="form-group"><label for="minorFullName">ReÅŸit OlmayanÄ±n AdÄ± SoyadÄ± *</label><input type="text" id="minorFullName" name="Resit_Olmayan_Adi_Soyadi"></div>
                            <div class="form-group"><label for="minorDob">ReÅŸit OlmayanÄ±n DoÄŸum Tarihi *</label><input type="date" id="minorDob" name="Resit_Olmayan_Dogum_Tarihi"></div>
                        </div>
                    </div>
                </div>
                 <div class="form-section">
                    <h3 class="section-title">ğŸ“‹ Ãœyelik SÃ¶zleÅŸmesi</h3>
                    <div class="contract-text" id="contractTextArea"></div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="agreeContract" name="Sozlesme_Onayi" value="Kabul Edildi" required>
                        <label for="agreeContract">Ãœyelik sÃ¶zleÅŸmesini okudum, anladÄ±m ve kabul ediyorum. *</label>
                    </div>
                </div>
                 <div class="form-section">
                    <h3 class="section-title">âœï¸ Dijital Ä°mza</h3>
                    <div class="signature-section">
                        <p>LÃ¼tfen aÅŸaÄŸÄ±daki alana imzanÄ±zÄ± atÄ±n:</p>
                        <canvas id="signatureCanvas" class="signature-canvas" width="400" height="200"></canvas>
                        <div><button type="button" class="btn btn-secondary" onclick="clearSignature()">Ä°mzayÄ± Temizle</button></div>
                        <div id="signatureWarning" class="warning" style="display: none; margin-top: 15px;"><strong>UyarÄ±:</strong> LÃ¼tfen dijital imzanÄ±zÄ± tamamlayÄ±n.</div>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 30px;">
                    <button type="submit" class="btn btn-success" id="submitBtn">ğŸ“„ SÃ¶zleÅŸmeyi Ä°mzala ve Onayla</button>
                </div>
                <div class="success-message" id="successMessage">
                    <h3>âœ… BaÅŸarÄ±lÄ±!</h3>
                    <p>Ãœyelik sÃ¶zleÅŸmeniz baÅŸarÄ±yla tamamlandÄ±. Onay belgesi indiriliyor ve bilgileriniz kulÃ¼bÃ¼mÃ¼ze iletiliyor.</p>
                </div>
            </form>
        </div>
    </div>

<script>
    // --- SABÄ°TLER ---
    const webhookUrl = 'https://n8n.edu-ai.online/webhook-test/10a31aa5-c942-46ec-bc5c-b221c24e5eae';
    const contractTextArea = document.getElementById('contractTextArea');
    
    // --- SÃ–ZLEÅME METNÄ° ---
    const getContractSections = () => {
        // DÃœZELTME: SÃ¶zleÅŸme metninin tamamÄ± geri eklendi ve 3 parÃ§aya bÃ¶lÃ¼ndÃ¼
        const part1 = `<h4>ÃœYELÄ°K SÃ–ZLEÅMESÄ°</h4>
        <p><strong>1-) TARAFLAR</strong><br>
        <strong>A-KULÃœP</strong><br>
        AdÄ±-SoyadÄ± : Aykut YILDIRIM<br>
        ÃœnvanÄ± : Atakum Tenis<br>
        Adres : Derecik Mahallesi 1444. Sokak No:1 Ä°lkadÄ±m/Samsun<br>
        Vergi No : 9540639540<br>
        Telefon : 0544 936 75 43<br>
        E-mail : y.aykut7455@gmail.com<br>
        Bu sÃ¶zleÅŸmede bundan sonra â€œEÄÄ°TMEN/KULÃœPâ€ olarak anÄ±lacaktÄ±r.<br>
        <strong>B-ÃœYE/VELÄ°</strong><br>
        Bu sÃ¶zleÅŸmede bundan sonra â€œÃœYE/VELÄ°â€ olarak anÄ±lacaktÄ±r. Ãœye ve varsa veliye ait bilgiler yukarÄ±da yer alan kÄ±sma ayrÄ± ayrÄ± yazÄ±larak doldurulacaktÄ±r.</p>
        <p>Ãœye/Veli iÅŸbu sÃ¶zleÅŸmeyi onaylamasÄ± sÄ±rasÄ±nda EÄŸitmen tarafÄ±ndan kendisinden talep edilen her tÃ¼rlÃ¼ bilgiyi eksiksiz ve doÄŸru olarak EÄŸitmene vermeyi kabul etmektedir. Ãœye/Veli, eÄŸitimler sÄ±rasÄ±nda EÄŸitmene bildirdiÄŸi bilgilerin doÄŸruluÄŸundan bizzat sorumludur.</p>
        <p><strong>2-) KONU</strong><br>
        Ä°ÅŸbu Ã¼yelik sÃ¶zleÅŸmesi, Ã¼yelik iÅŸlemlerinin gerÃ§ekleÅŸtirilmesi ile iÅŸbu sÃ¶zleÅŸmenin onaylanmasÄ± suretiyle, EÄŸitmen tarafÄ±ndan sunulacak hizmetin ÅŸartlarÄ±nÄ± ve taraflarÄ±n karÅŸÄ±lÄ±klÄ± hak ve yÃ¼kÃ¼mlÃ¼lÃ¼klerini dÃ¼zenlemektedir.</p>
        <p><strong>3-) SÃœRE</strong><br>
        SÃ¶zleÅŸme sÃ¼resi aylÄ±k ve 6 aylÄ±k periyotlar halinde dÃ¼zenlenmekte olup; kayÄ±tlar sÃ¶zleÅŸmenin biteceÄŸi ayÄ±n 15â€™inden Ã¶nce iptal edilmediÄŸi takdirde aylÄ±k veya 6 aylÄ±k olarak uzatÄ±lmÄ±ÅŸ sayÄ±lmaktadÄ±r. KayÄ±t silinmediÄŸi takdirde yeni dÃ¶neme iliÅŸkin Ã¼cret Ãœye/Veli tarafÄ±ndan kulÃ¼be Ã¶denecektir.</p>
        <p><strong>4-) ÃœCRET</strong><br>
        Ãœyelik bedeli, Ãœyelik satÄ±ÅŸ formunda belirtilen Ã¼yelik paketine gÃ¶re â€¦. Ay, aylÄ±kâ€¦â€¦.. TL olup; iÅŸbu bedel Ãœye/Veli tarafÄ±ndan Ã¶denecektir.</p>
        <p><strong>5-) Ã–DEMELER</strong><br>
        Ã–demelerin her ayÄ±n 20â€™sine kadar belirtilen hesaba yapÄ±lmasÄ± gerekmektedir. DÃ¶nem tarihlerine gÃ¶re eksik ya da fazla Ã¶deme durumu oluÅŸabilir. Ã–demelerin zamanÄ±nda yapÄ±lmamasÄ± durumunda; Ãœye/Veli, yapacaÄŸÄ± Ã¶demenin %25â€™i tutarÄ±nda cezai ÅŸart Ã¶demeyi kabul ve taahhÃ¼t eder.</p>`;
        
        const part2 = `<p><strong>6-) ÃœYELÄ°K Ä°PTALLERÄ°</strong><br>
        Her ayÄ±n 14â€™Ã¼ kayÄ±t sildirme iÃ§in son gÃ¼ndÃ¼r. Bu tarihler sonrasÄ±nda yapÄ±lan kayÄ±t sildirmelerde yeni dÃ¶nem Ã¼creti tahsil edilir. KulÃ¼be veya kulÃ¼p tesislerine zarar verici davranÄ±ÅŸlarda bulunulmasÄ± durumunda kulÃ¼p Ã¼yeliÄŸi sonlandÄ±rÄ±labilir.</p>
        <p><strong>7-) EÄÄ°TÄ°ME Ä°LÄ°ÅKÄ°N KURALLAR</strong><br>
        A) Ãœyelik ÅartlarÄ± ile Ãœye/Velinin Hak ve YÃ¼kÃ¼mlÃ¼lÃ¼kleri<br>
        1) EÄŸitmen, her tÃ¼rlÃ¼ Ã¼yelik talebini hiÃ§bir gerekÃ§e gÃ¶stermeksizin tek taraflÄ± olarak reddetme hakkÄ±na sahiptir.<br>
        2) EÄŸitmenden, suÃ§ iÅŸlememiÅŸ ve herhangi bir yÃ¼z kÄ±zartÄ±cÄ± suÃ§tan sabÄ±ka kaydÄ± bulunmayan T.C. vatandaÅŸlarÄ± ile yabancÄ± uyruklu kiÅŸiler ders alabilir.<br>
        3) EÄŸitmen Ãœye/Veliden, bulaÅŸÄ±cÄ± hastalÄ±klar gibi toplumu veya diÄŸer Ãœye/Velilerin saÄŸlÄ±ÄŸÄ±nÄ± tehlikeye dÃ¼ÅŸÃ¼rebilecek bir hastalÄ±ÄŸÄ±nÄ±n bulunmadÄ±ÄŸÄ±na dair saÄŸlÄ±k raporu ya da tahlil sonucu talep edebilir.<br>
        B) KULÃœP KURALLARI<br>
        a) Grup dersleri aylÄ±k 8 derstir.<br>
        b) Grup derslerinde ders bir kez iÅŸlendiÄŸinden, Ã¼yenin katÄ±lamadÄ±ÄŸÄ± dersler iÃ§in telafi yapÄ±lmaz.<br>
        c) Ã–zel ders paketleri 1 aylÄ±k sÃ¼reyle geÃ§erlidir. Bu sÃ¼re iÃ§inde kullanÄ±lmayan ders haklarÄ± bir sonraki aya devredilmez.<br>
        C) GENEL KURALLAR<br>
        1) KulÃ¼p bÃ¼nyesinde Ãœye/Veliler genel nezaket kurallarÄ±na uymakla yÃ¼kÃ¼mlÃ¼dÃ¼rler.<br>
        2) KayÄ±p eÅŸyalardan KulÃ¼p sorumlu deÄŸildir.<br>
        3) Ãœye/Veli ruhsatlÄ± bile olsa KulÃ¼pâ€™e delici, kesici ve patlayÄ±cÄ± alet veya silahla giremez.`;
        
        const part3 = `<p><strong>8- KÄ°ÅÄ°SEL VE Ã–ZEL NÄ°TELÄ°KLÄ° KÄ°ÅÄ°SEL VERÄ°LERÄ°N Ä°ÅLENMESÄ°</strong><br>
        Ãœye/Veli, iÅŸbu sÃ¶zleÅŸmeye taraf olma suretiyle, verdiÄŸi tÃ¼m bilgilerin ve/veya Ãœye/Velilik iliÅŸkisinin devamÄ±na herhangi bir suretle KulÃ¼pâ€™e verdiÄŸi tÃ¼m kiÅŸisel bilgilerinin iÅŸlenmesine aÃ§Ä±kÃ§a izin verdiÄŸini kabul, beyan ve taahhÃ¼t eder.</p>
        <p><strong>9-) SON HÃœKÃœMLER</strong><br>
        1) Bu anlaÅŸmanÄ±n uygulanmasÄ±ndan kaynaklanan tÃ¼m ihtilaflarda Samsun mahkemeleri ve icra daireleri yetkilidir.<br>
        2) TaraflarÄ±n sÃ¶zleÅŸmenin giriÅŸinde unvanlarÄ± altÄ±nda adresler sÃ¶zleÅŸme uyarÄ±nca kanuni tebligat adresleri olarak kabul edilecektir.<br>
        -ReÅŸit olmayan katÄ±lÄ±mcÄ±larÄ±n velileri veya vasileri iÃ§in Ãœye, iÅŸbu belge ile aÅŸaÄŸÄ±da adÄ± geÃ§en katÄ±lÄ±mcÄ± iÃ§in yasal sorumluluÄŸu olan bir veli/vasi olarak, yukarÄ±da belirtilen ÅŸekilde ÅŸahsÄ±n ibrasÄ±na muvafakat ettiÄŸini ve ibrayÄ± kabul ettiÄŸini beyan eder.</p>`;

        return [part1, part2, part3];
    };
    
    const fullContractHtml = getContractSections().join('<hr>');
    contractTextArea.innerHTML = fullContractHtml;

    // --- FORM Ä°NTERAKTÄ°VÄ°TESÄ° ---
    const durationSelect = document.getElementById('membershipDuration');
    durationSelect.addEventListener('change', function() {
        document.getElementById('monthlyWarning').style.display = (this.value === 'AylÄ±k') ? 'block' : 'none';
        document.getElementById('fourMonthWarning').style.display = (this.value === '4 AylÄ±k') ? 'block' : 'none';
    });

    const isMinorCheck = document.getElementById('isMinorCheck');
    const minorFullNameInput = document.getElementById('minorFullName');
    const minorDobInput = document.getElementById('minorDob');
    isMinorCheck.addEventListener('change', function() {
        const isChecked = this.checked;
        document.getElementById('minorFields').style.display = isChecked ? 'block' : 'none';
        minorFullNameInput.required = isChecked;
        minorDobInput.required = isChecked;
    });

    // --- Ä°MZA CANVAS ---
    const canvas = document.getElementById('signatureCanvas');
    const ctx = canvas.getContext('2d');
    let hasSignature = false;
    function resizeCanvas(){const container=canvas.parentElement;canvas.width=Math.min(400,container.clientWidth-60);canvas.height=200;ctx.strokeStyle="#2d5a27";ctx.lineWidth=2;ctx.lineCap="round"}window.addEventListener("resize",resizeCanvas);resizeCanvas();let isDrawing=!1;const getCoords=e=>{const t=canvas.getBoundingClientRect(),n=e.touches?e.touches[0]:null;return{x:(n?n.clientX:e.clientX)-t.left,y:(n?n.clientY:e.clientY)-t.top}},startDrawing=e=>{e.preventDefault(),isDrawing=!0,hasSignature=!0;const{x:t,y:n}=getCoords(e);ctx.beginPath(),ctx.moveTo(t,n)},draw=e=>{if(!isDrawing)return;e.preventDefault();const{x:t,y:n}=getCoords(e);ctx.lineTo(t,n),ctx.stroke()},stopDrawing=()=>{isDrawing=!1};canvas.addEventListener("mousedown",startDrawing);canvas.addEventListener("mousemove",draw);canvas.addEventListener("mouseup",stopDrawing);canvas.addEventListener("mouseout",stopDrawing);canvas.addEventListener("touchstart",startDrawing);canvas.addEventListener("touchmove",draw);canvas.addEventListener("touchend",stopDrawing);function clearSignature(){ctx.clearRect(0,0,canvas.width,canvas.height),hasSignature=!1,document.getElementById("signatureWarning").style.display="none"}
    
    // --- ANA FORM GÃ–NDERME MANTIÄI ---
    document.getElementById('membershipForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        if (!hasSignature) { document.getElementById('signatureWarning').style.display = 'block'; return; }
        
        const submitBtn = document.getElementById('submitBtn');
        submitBtn.disabled = true;
        submitBtn.textContent = 'Ä°ÅŸleniyor...';

        const formData = Object.fromEntries(new FormData(this).entries());
        formData.timestamp = new Date().toISOString();
        formData.signature = canvas.toDataURL('image/png');

        try {
            // 1. KullanÄ±cÄ± iÃ§in RESÄ°MLERÄ° oluÅŸtur ve indir
            await downloadAsImages(formData);

            // 2. Webhook'a veriyi gÃ¶nder
            try {
                 await fetch(webhookUrl, {
                    method: 'POST',
                    body: JSON.stringify(formData),
                    headers: { 'Content-Type': 'application/json' },
                    mode: 'no-cors'
                });
            } catch (webhookError) {
                console.error("Webhook gÃ¶nderim hatasÄ± (Bu hata normal olabilir):", webhookError);
            }

            document.getElementById('successMessage').style.display = 'block';
            this.reset();
            clearSignature();
            document.getElementById('monthlyWarning').style.display = 'none';
            document.getElementById('fourMonthWarning').style.display = 'none';
            document.getElementById('minorFields').style.display = 'none';

        } catch (error) {
            console.error("Ana iÅŸlem sÄ±rasÄ±nda hata oluÅŸtu:", error);
            alert("Bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.");
        } finally {
            submitBtn.disabled = false;
            submitBtn.textContent = 'ğŸ“„ SÃ¶zleÅŸmeyi Ä°mzala ve Onayla';
        }
    });

    // --- YENÄ° VE GÃœVENÄ°LÄ°R RESÄ°M OLUÅTURMA FONKSÄ°YONU ---
    async function downloadAsImages(data) {
        
        const generatePageHtml = (pageNumber, pageContent, d, totalPages) => {
            const isFirstPage = pageNumber === 1;
            const isLastPage = pageNumber === totalPages;

            const headerHtml = isFirstPage ? `
                <div class="pdf-section">
                    <h3>ÃœYE / VELÄ° BÄ°LGÄ°LERÄ°</h3>
                    <p><strong>Ad Soyad:</strong> ${d.Ad_Soyad}</p>
                    <p><strong>T.C. Kimlik No:</strong> ${d.TC_Kimlik_No}</p>
                    <p><strong>Telefon:</strong> ${d.Telefon}</p>
                    <p><strong>E-posta:</strong> ${d.Eposta}</p>
                    <p><strong>Adres:</strong> ${d.Adres}</p>
                    <p><strong>Ãœyelik SÃ¼resi:</strong> ${d.Uyelik_Suresi}</p>
                </div>
            ` + (d.Resit_Olmayan_Uye_Mi === 'on' ? `
                <div class="pdf-section">
                    <h3>REÅÄ°T OLMAYAN ÃœYE BÄ°LGÄ°LERÄ°</h3>
                    <p><strong>AdÄ± SoyadÄ±:</strong> ${d.Resit_Olmayan_Adi_Soyadi}</p>
                    <p><strong>DoÄŸum Tarihi:</strong> ${d.Resit_Olmayan_Dogum_Tarihi}</p>
                </div>` : '') : '';
            
            const footerHtml = isLastPage ? `
                <div class="pdf-section signature-block">
                    <h3>ONAY VE Ä°MZA</h3>
                    <p>YukarÄ±daki sÃ¶zleÅŸmeyi okuduÄŸumu, anladÄ±ÄŸÄ±mÄ± ve tÃ¼m ÅŸartlarÄ±nÄ± kabul ettiÄŸimi beyan ederim.</p>
                    <p><strong>Ä°mza Tarihi:</strong> ${new Date(d.timestamp).toLocaleString('tr-TR')}</p>
                    <div class="signature-container">
                         <img src="${d.signature}" />
                         <p><strong>Ä°sim Soyisim:</strong><br>${d.Ad_Soyad}</p>
                    </div>
                </div>
            ` : '';

            return `
            <!DOCTYPE html><html lang="tr"><head><meta charset="UTF-8">
            <style>
                body { font-family: 'Helvetica', 'Arial', sans-serif; font-size: 12px; line-height: 1.5; color: #333; }
                .pdf-container { width: 800px; margin: 0 auto; padding: 40px; background: white; border: 1px solid #ccc; display: flex; flex-direction: column; height: 1120px; }
                h1 { font-size: 24px; text-align: center; color: #2d5a27; border-bottom: 2px solid #2d5a27; padding-bottom: 10px; margin-bottom: 20px; }
                .pdf-section { margin-bottom: 15px; padding: 15px; border: 1px solid #e1e5e9; border-radius: 10px; }
                .pdf-section h3 { font-size: 16px; color: #667eea; margin-top: 0; margin-bottom: 10px; }
                .contract { font-size: 10px; flex-grow: 1; } p { margin: 0 0 5px 0; }
                .signature-container { display: flex; align-items: flex-end; margin-top: 20px; }
                .signature-container img { width: 200px; border-bottom: 1px solid #ccc; }
                .signature-container p { margin-left: 20px; padding-bottom: 5px; }
                .page-footer { text-align: center; margin-top: auto; font-size: 10px; color: #888; padding-top: 20px;}
            </style>
            </head><body>
                <div class="pdf-container">
                    <div>
                        <h1>Atakum Tenis KulÃ¼bÃ¼ Ãœyelik SÃ¶zleÅŸmesi</h1>
                        ${headerHtml}
                        <div class="pdf-section contract">
                            <h3>SÃ–ZLEÅME METNÄ°</h3>
                            ${pageContent}
                        </div>
                        ${footerHtml}
                    </div>
                    <div class="page-footer">Sayfa ${pageNumber} / ${totalPages}</div>
                </div>
            </body></html>`;
        };
        
        const contractParts = getContractSections();

        for (let i = 0; i < contractParts.length; i++) {
            const pageHtml = generatePageHtml(i + 1, contractParts[i], data, contractParts.length);
            
            const tempContainer = document.createElement('div');
            tempContainer.style.position = 'absolute';
            tempContainer.style.left = '-9999px'; // Ekran dÄ±ÅŸÄ±nda render et
            tempContainer.innerHTML = pageHtml;
            document.body.appendChild(tempContainer);

            const canvas = await html2canvas(tempContainer.querySelector('.pdf-container'), {
                scale: 2,
                useCORS: true
            });

            document.body.removeChild(tempContainer);

            const link = document.createElement('a');
            link.download = `${data.Ad_Soyad.replace(/\s+/g, '_')}_sayfa_${i + 1}.jpeg`;
            link.href = canvas.toDataURL('image/jpeg', 0.98);
            link.click();
            
            await new Promise(resolve => setTimeout(resolve, 500)); 
        }
    }
</script>
</body>
</html>

