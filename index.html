<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atakum Tenis KulÃ¼bÃ¼ - Ãœyelik SÃ¶zleÅŸmesi</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        (function() {
            // LÃœTFEN GÃœNCELLEYÄ°N: EmailJS hesabÄ±nÄ±zdaki 'User ID'nizi yapÄ±ÅŸtÄ±rÄ±n
            emailjs.init("SENIN_USER_ID_N"); 
        })();
    </script>
    <style>
        /* Stil kodlarÄ±nÄ±zda deÄŸiÅŸiklik yok, aynÄ± kalabilir */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.1); overflow: hidden; }
        .header { background: linear-gradient(135deg, #2d5a27 0%, #4a7c59 100%); color: white; padding: 30px; text-align: center; }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .header p { font-size: 1.2em; opacity: 0.9; }
        .form-container { padding: 40px; }
        .form-section { margin-bottom: 30px; padding: 25px; border-radius: 15px; background: #f8f9ff; border-left: 5px solid #667eea; }
        .section-title { font-size: 1.4em; color: #2d5a27; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .form-group { display: flex; flex-direction: column; }
        label { font-weight: 600; color: #333; margin-bottom: 8px; font-size: 0.95em; }
        input, select, textarea { padding: 12px 15px; border: 2px solid #e1e5e9; border-radius: 10px; font-size: 1em; transition: all 0.3s ease; }
        input:focus, select:focus, textarea:focus { outline: none; border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); }
        .contract-text { background: white; padding: 25px; border-radius: 10px; border: 2px solid #e1e5e9; height: 400px; overflow-y: auto; font-size: 0.85em; line-height: 1.6; color: #333; }
        .signature-section { background: #fff; border: 2px dashed #667eea; border-radius: 15px; padding: 30px; text-align: center; }
        .signature-canvas { border: 2px solid #e1e5e9; border-radius: 10px; cursor: crosshair; display: block; margin: 20px auto; }
        .btn { padding: 12px 25px; border: none; border-radius: 25px; font-size: 1em; font-weight: 600; cursor: pointer; transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 0.5px; }
        .btn-secondary { background: #f8f9fa; color: #6c757d; border: 2px solid #e1e5e9; }
        .btn-success { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; font-size: 1.2em; padding: 15px 40px; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0,0,0,0.15); }
        .checkbox-group { display: flex; align-items: center; gap: 15px; margin-top: 20px; }
        .warning, .info-box { background: #fff3cd; border-left: 5px solid #ffeaa7; color: #856404; padding: 15px; border-radius: 10px; margin: 15px 0; }
        .success-message { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; padding: 20px; border-radius: 15px; text-align: center; margin-top: 20px; display: none; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¾ Atakum Tenis KulÃ¼bÃ¼</h1>
            <p>Online Ãœyelik SÃ¶zleÅŸmesi</p>
        </div>

        <div class="form-container">
            <form id="membershipForm">
                
                <div class="form-section">
                    <h3 class="section-title">ğŸ‘¤ Ãœye / Veli Bilgileri</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="fullName">Ad Soyad *</label>
                            <input type="text" id="fullName" name="fullName" required>
                        </div>
                        <div class="form-group">
                            <label for="tcno">T.C. Kimlik No *</label>
                            <input type="text" id="tcno" name="tcno" pattern="[0-9]{11}" maxlength="11" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Telefon *</label>
                            <input type="tel" id="phone" name="phone" required>
                        </div>
                        <div class="form-group">
                            <label for="email">E-posta *</label>
                            <input type="email" id="email" name="email" required>
                        </div>
                    </div>
                    <div class="form-group" style="margin-top: 20px;">
                        <label for="address">Adres *</label>
                        <textarea id="address" name="address" rows="3" required></textarea>
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="section-title">ğŸ—“ï¸ Ãœyelik SÃ¼resi</h3>
                    <div class="form-group">
                        <label for="membershipDuration">Ãœyelik SÃ¼resini SeÃ§iniz *</label>
                        <select id="membershipDuration" name="membershipDuration" required>
                            <option value="">SeÃ§iniz...</option>
                            <option value="AylÄ±k">AylÄ±k</option>
                            <option value="4 AylÄ±k">4 AylÄ±k</option>
                        </select>
                    </div>
                    <div id="monthlyWarning" class="info-box" style="display: none;">
                        <strong>Bilgilendirme:</strong> AylÄ±k Ã¼yeliklerde, Ã¼yeliÄŸinizi sonlandÄ±rmak iÃ§in her ayÄ±n 14'Ã¼ne kadar kayÄ±t sildirmeniz gerekmektedir. Aksi takdirde Ã¼yelik otomatik olarak yenilenir.
                    </div>
                    <div id="fourMonthWarning" class="info-box" style="display: none;">
                        <strong>Bilgilendirme:</strong> 4 aylÄ±k Ã¼yeliklerde, sÃ¼reden Ã¶nce iptal edilen Ã¼yeliklerde sÃ¶zleÅŸme gereÄŸi cayma bedeli tahsil edilir.
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="section-title">ğŸ‘¶ ReÅŸit Olmayan Ãœye</h3>
                    <div class="checkbox-group">
                        <input type="checkbox" id="isMinorCheck" name="isMinorCheck" style="width: 20px; height: 20px;">
                        <label for="isMinorCheck">18 yaÅŸÄ±ndan kÃ¼Ã§Ã¼k bir Ã¼ye iÃ§in dolduruyorum.</label>
                    </div>
                    <div id="minorFields" style="display: none; margin-top: 20px;">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="minorFullName">ReÅŸit OlmayanÄ±n AdÄ± SoyadÄ± *</label>
                                <input type="text" id="minorFullName" name="minorFullName">
                            </div>
                            <div class="form-group">
                                <label for="minorDob">ReÅŸit OlmayanÄ±n DoÄŸum Tarihi *</label>
                                <input type="date" id="minorDob" name="minorDob">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-section">
                    <h3 class="section-title">ğŸ“‹ Ãœyelik SÃ¶zleÅŸmesi</h3>
                    <div class="contract-text">
                        <h4>ÃœYELÄ°K SÃ–ZLEÅMESÄ°</h4>
                        <p><strong>1-) TARAFLAR</strong><br>
                        <strong>A-KULÃœP</strong><br>
                        AdÄ±-SoyadÄ± : Aykut YILDIRIM<br>
                        ÃœnvanÄ± : Atakum Tenis<br>
                        Adres : Derecik Mahallesi 1444. Sokak No:1 Ä°lkadÄ±m/Samsun<br>
                        Vergi No : 9540639540<br>
                        Telefon : 0544 936 75 43<br>
                        E-mail : y.aykut7455@gmail.com<br>
                        Bu sÃ¶zleÅŸmede bundan sonra â€œEÄÄ°TMEN/KULÃœPâ€ olarak anÄ±lacaktÄ±r.<br>
                        <strong>B-ÃœYE/VELÄ°</strong><br>
                        AdÄ±-SoyadÄ± : [Bu alan formdan otomatik doldurulacaktÄ±r]<br>
                        Adres : [Bu alan formdan otomatik doldurulacaktÄ±r]<br>
                        TCKN : [Bu alan formdan otomatik doldurulacaktÄ±r]<br>
                        Telefon : [Bu alan formdan otomatik doldurulacaktÄ±r]<br>
                        E-mail : [Bu alan formdan otomatik doldurulacaktÄ±r]<br>
                        Bu sÃ¶zleÅŸmede bundan sonra â€œÃœYE/VELÄ°â€ olarak anÄ±lacaktÄ±r.</p>
                        
                        <p><strong>2-) KONU</strong><br>
                        Ä°ÅŸbu Ã¼yelik sÃ¶zleÅŸmesi, Ã¼yelik iÅŸlemlerinin gerÃ§ekleÅŸtirilmesi ile iÅŸbu sÃ¶zleÅŸmenin onaylanmasÄ± suretiyle, EÄŸitmen tarafÄ±ndan sunulacak hizmetin ÅŸartlarÄ±nÄ± ve taraflarÄ±n karÅŸÄ±lÄ±klÄ± hak ve yÃ¼kÃ¼mlÃ¼lÃ¼klerini dÃ¼zenlemektedir.</p>
                        
                        <p><strong>8- KÄ°ÅÄ°SEL VE Ã–ZEL NÄ°TELÄ°KLÄ° KÄ°ÅÄ°SEL VERÄ°LERÄ°N Ä°ÅLENMESÄ°</strong><br>
                        Ãœye/Veli, iÅŸbu sÃ¶zleÅŸmeye taraf olma suretiyle, verdiÄŸi tÃ¼m bilgilerin... [sÃ¶zleÅŸmenin geri kalanÄ±]</p>
                        
                        <p><strong>9-) SON HÃœKÃœMLER</strong><br>
                        1) Bu anlaÅŸmanÄ±n uygulanmasÄ±ndan kaynaklanan tÃ¼m ihtilaflarda Samsun mahkemeleri ve icra daireleri yetkilidir...</p>

                        <p><strong>-ReÅŸit olmayan katÄ±lÄ±mcÄ±larÄ±n velileri veya vasileri iÃ§in...</strong></p>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="agreeContract" name="agreeContract" required>
                        <label for="agreeContract">Ãœyelik sÃ¶zleÅŸmesini okudum, anladÄ±m ve kabul ediyorum. *</label>
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="section-title">âœï¸ Dijital Ä°mza</h3>
                    <div class="signature-section">
                        <p>LÃ¼tfen aÅŸaÄŸÄ±daki alana imzanÄ±zÄ± atÄ±n:</p>
                        <canvas id="signatureCanvas" class="signature-canvas" width="400" height="200"></canvas>
                        <div class="signature-buttons">
                            <button type="button" class="btn btn-secondary" onclick="clearSignature()">Ä°mzayÄ± Temizle</button>
                        </div>
                        <div id="signatureWarning" class="warning" style="display: none;">
                            <strong>UyarÄ±:</strong> LÃ¼tfen dijital imzanÄ±zÄ± tamamlayÄ±n.
                        </div>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 30px;">
                    <button type="submit" class="btn btn-success" id="submitBtn">
                        ğŸ“„ SÃ¶zleÅŸmeyi Ä°mzala ve Onayla
                    </button>
                </div>

                <div class="success-message" id="successMessage">
                    <h3>âœ… BaÅŸarÄ±lÄ±!</h3>
                    <p>Ãœyelik sÃ¶zleÅŸmeniz baÅŸarÄ±yla tamamlandÄ±. PDF dosyasÄ± indiriliyor ve bir kopyasÄ± kulÃ¼bÃ¼mÃ¼ze iletildi.</p>
                </div>
            </form>
        </div>
    </div>

<script>
    // Dinamik uyarÄ±lar ve reÅŸit olmayan formu iÃ§in JavaScript
    const durationSelect = document.getElementById('membershipDuration');
    const monthlyWarning = document.getElementById('monthlyWarning');
    const fourMonthWarning = document.getElementById('fourMonthWarning');
    const isMinorCheck = document.getElementById('isMinorCheck');
    const minorFields = document.getElementById('minorFields');
    const minorFullNameInput = document.getElementById('minorFullName');
    const minorDobInput = document.getElementById('minorDob');

    durationSelect.addEventListener('change', function() {
        if (this.value === 'AylÄ±k') {
            monthlyWarning.style.display = 'block';
            fourMonthWarning.style.display = 'none';
        } else if (this.value === '4 AylÄ±k') {
            monthlyWarning.style.display = 'none';
            fourMonthWarning.style.display = 'block';
        } else {
            monthlyWarning.style.display = 'none';
            fourMonthWarning.style.display = 'none';
        }
    });

    isMinorCheck.addEventListener('change', function() {
        if (this.checked) {
            minorFields.style.display = 'block';
            minorFullNameInput.required = true;
            minorDobInput.required = true;
        } else {
            minorFields.style.display = 'none';
            minorFullNameInput.required = false;
            minorDobInput.required = false;
        }
    });

    // Ä°mza Canvas'Ä± ve Form GÃ¶nderme KodlarÄ± (Ã–ncekiyle Benzer)
    const canvas = document.getElementById('signatureCanvas');
    const ctx = canvas.getContext('2d');
    let isDrawing = false;
    let hasSignature = false;

    // Canvas ve imza fonksiyonlarÄ±... (deÄŸiÅŸiklik yok)
    function resizeCanvas() { const container = canvas.parentElement; const containerWidth = container.clientWidth - 60; canvas.width = Math.min(400, containerWidth); canvas.height = 200; ctx.strokeStyle = '#2d5a27'; ctx.lineWidth = 2; ctx.lineCap = 'round'; }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();
    canvas.addEventListener('mousedown', (e) => { isDrawing = true; const rect = canvas.getBoundingClientRect(); ctx.beginPath(); ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top); hasSignature = true; });
    canvas.addEventListener('mousemove', (e) => { if (!isDrawing) return; const rect = canvas.getBoundingClientRect(); ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top); ctx.stroke(); });
    const stopDrawing = () => { isDrawing = false; };
    canvas.addEventListener('mouseup', stopDrawing);
    canvas.addEventListener('mouseout', stopDrawing);
    canvas.addEventListener('touchstart', (e) => { e.preventDefault(); const touch = e.touches[0]; const mouseEvent = new MouseEvent('mousedown', { clientX: touch.clientX, clientY: touch.clientY }); canvas.dispatchEvent(mouseEvent); });
    canvas.addEventListener('touchmove', (e) => { e.preventDefault(); const touch = e.touches[0]; const mouseEvent = new MouseEvent('mousemove', { clientX: touch.clientX, clientY: touch.clientY }); canvas.dispatchEvent(mouseEvent); });
    canvas.addEventListener('touchend', stopDrawing);
    function clearSignature() { ctx.clearRect(0, 0, canvas.width, canvas.height); hasSignature = false; document.getElementById('signatureWarning').style.display = 'none'; }
    
    // Form gÃ¶nderme iÅŸlemi
    document.getElementById('membershipForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        if (!hasSignature) { document.getElementById('signatureWarning').style.display = 'block'; return; }

        const submitBtn = document.getElementById('submitBtn');
        submitBtn.disabled = true;
        submitBtn.textContent = 'Ä°ÅŸleniyor...';

        const formData = new FormData(this);
        const memberData = Object.fromEntries(formData.entries());

        try {
            await generateAndSendPDF(memberData);
            document.getElementById('successMessage').style.display = 'block';
        } catch (error) {
            console.error('Hata:', error);
            alert('Bir hata oluÅŸtu: ' + JSON.stringify(error));
        } finally {
            submitBtn.disabled = false;
            submitBtn.textContent = 'ğŸ“„ SÃ¶zleÅŸmeyi Ä°mzala ve Onayla';
        }
    });

    // PDF OluÅŸturma, GÃ¶nderme ve Ä°ndirme Fonksiyonu (GÃœNCELLENDÄ°)
    async function generateAndSendPDF(data) {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF({ unit: 'pt', format: 'a4' });

        // jsPDF'in Ã§ok satÄ±rlÄ± metinleri iÅŸlemesi iÃ§in ayarlar
        const page_margin = 50;
        const line_height = 15;
        const page_width = doc.internal.pageSize.getWidth();
        let yPos = page_margin;

        // Metin ekleme yardÄ±mcÄ± fonksiyonu
        function addText(text, options = {}) {
            const splitText = doc.splitTextToSize(text, page_width - page_margin * 2);
            doc.setFont(options.font || 'helvetica', options.style || 'normal');
            doc.setFontSize(options.size || 10);
            doc.text(splitText, page_margin, yPos);
            yPos += (splitText.length * line_height);
            if (yPos > doc.internal.pageSize.getHeight() - page_margin) {
                doc.addPage();
                yPos = page_margin;
            }
        }
        
        // --- PDF Ä°Ã‡ERÄ°ÄÄ° ---
        addText('ÃœYELÄ°K SÃ–ZLEÅMESÄ°', { size: 16, style: 'bold' });
        yPos += line_height;

        addText('1-) TARAFLAR', { style: 'bold' });
        addText('A-KULÃœP', { style: 'bold' });
        addText('AdÄ±-SoyadÄ± : Aykut YILDIRIM\nÃœnvanÄ± : Atakum Tenis\nAdres : Derecik Mahallesi 1444. Sokak No:1 Ä°lkadÄ±m/Samsun\nVergi No : 9540639540\nTelefon : 0544 936 75 43\nE-mail : y.aykut7455@gmail.com');
        yPos += line_height;
        
        // Ãœye bilgileri formdan alÄ±nÄ±p ekleniyor
        addText('B-ÃœYE/VELÄ°', { style: 'bold' });
        addText(`AdÄ±-SoyadÄ± : ${data.fullName}\nAdres : ${data.address}\nTCKN : ${data.tcno}\nTelefon : ${data.phone}\nE-mail : ${data.email}`);
        yPos += line_height;
        
        // SÃ¶zleÅŸmenin geri kalanÄ±
        addText("Ä°ÅŸbu sÃ¶zleÅŸmede bundan sonra â€œÃœYE/VELÄ°â€ olarak anÄ±lacaktÄ±r. Ãœye ve varsa veliye ait bilgiler yukarÄ±da yer alan kÄ±sma ayrÄ± ayrÄ± yazÄ±larak doldurulacaktÄ±r. Ãœye/Veli iÅŸbu sÃ¶zleÅŸmeyi onaylamasÄ± sÄ±rasÄ±nda EÄŸitmen tarafÄ±ndan kendisinden talep edilen her tÃ¼rlÃ¼ bilgiyi eksiksiz ve doÄŸru olarak EÄŸitmene vermeyi kabul etmektedir. Ãœye/Veli, eÄŸitimler sÄ±rasÄ±nda EÄŸitmene bildirdiÄŸi bilgilerin doÄŸruluÄŸundan bizzat sorumludur.", {size: 8});
        // ... TÃ¼m sÃ¶zleÅŸme metnini buraya aynÄ± mantÄ±kla ekleyebilirsiniz.
        yPos += line_height;

        // ReÅŸit olmayan Ã¼ye bilgileri ekleniyor (eÄŸer seÃ§ildiyse)
        if (data.isMinorCheck === 'on') {
            addText('REÅÄ°T OLMAYAN ÃœYE BEYANI', { style: 'bold' });
            addText(`-ReÅŸit olmayan katÄ±lÄ±mcÄ±nÄ±n velisi olarak, aÅŸaÄŸÄ±da bilgileri bulunan katÄ±lÄ±mcÄ± adÄ±na sÃ¶zleÅŸmeyi kabul ettiÄŸimi beyan ederim.`);
            addText(`ReÅŸit OlmayanÄ±n AdÄ± ve SoyadÄ±: ${data.minorFullName}`);
            addText(`ReÅŸit OlmayanÄ±n DoÄŸum Tarihi: ${data.minorDob}`);
            addText(`Velisinin/Vasisinin AdÄ± ve SoyadÄ±: ${data.fullName}`);
            yPos += line_height;
        }

        addText('ONAY VE Ä°MZA', { style: 'bold' });
        addText('YukarÄ±daki sÃ¶zleÅŸme metnini okuduÄŸumu, anladÄ±ÄŸÄ±mÄ± ve tÃ¼m ÅŸartlarÄ± kabul ettiÄŸimi beyan ederim.');
        
        // Zaman DamgasÄ±
        const timestamp = new Date().toLocaleString('tr-TR');
        addText(`Ä°mza Tarihi ve Zaman DamgasÄ±: ${timestamp}`);
        yPos += line_height;

        // Ä°mza
        const signatureData = canvas.toDataURL();
        doc.addImage(signatureData, 'PNG', page_margin, yPos, 160, 60);

        // --- PDF GÃ–NDERME VE Ä°NDÄ°RME ---
        const pdfBase64 = doc.output('datauristring').split(',')[1];
        
        const templateParams = {
            ...data,
            timestamp: timestamp,
            attachment: pdfBase64,
            pdf_name: `${data.fullName.replace(/ /g, '_')}_sozlesme.pdf`
        };

        // LÃœTFEN GÃœNCELLEYÄ°N: Kendi EmailJS bilgilerinizi girin
        await emailjs.send('SENIN_SERVICE_ID_N', 'SENIN_TEMPLATE_ID_N', templateParams);

        doc.save(`${data.fullName.replace(/ /g, '_')}_uyelik_sozlesmesi.pdf`);
    }
</script>
</body>
</html>